@model MovieList

<h2 class ="searchResultHeader">Movies</h2>

<!-- Pagination Controls at the Top -->

<!--TODO Move the is page 1 check-->

<div class="pagination-controls">
    @if (Model.CurrentPage > 1)
    {
        <a href="@Url.Action("Search", new { query = Context.Request.Query["query"], genre = Context.Request.Query["genre"], actor = Context.Request.Query["actor"], year = Context.Request.Query["year"], page = Model.CurrentPage - 1 })" class="btn btn-primary">Previous</a>
    }

    <span>Page @Model.CurrentPage of @Model.TotalPages</span>

    @if (Model.CurrentPage < Model.TotalPages)
    {
        <a href="@Url.Action("Search", new { query = Context.Request.Query["query"], genre = Context.Request.Query["genre"], actor = Context.Request.Query["actor"], year = Context.Request.Query["year"], page = Model.CurrentPage + 1 })" class="btn btn-primary">Next</a>
    }
</div>



<!-- List of movies. TODO trending as default when no search is made -->
<div class="container">
    <div class="row">
        @if (Model.Movies == null)
        {
            <p>Model is null.</p>
        }
        else if (Model.Movies.Count == 0)
        {
            <p>No items found.</p>
        }
        else
        {
            @foreach (var item in Model.Movies)
            {
                
                <div class="col-md-3 mb-4">
                    <a href="/Movie/Index?movieId=@item.Id">
                    <div class="card">
                            <img src="https://image.tmdb.org/t/p/w500/@item.PosterPath" class="card-img-top" onerror="this.onerror=null; this.src='https://upload.wikimedia.org/wikipedia/commons/f/fc/No_picture_available.png';">
                            <div class="card-body">

                            
                                    <h5 class="card-title">
                                    
                                        @item.Title

                                    </h5>
                                    <p class=" card-releasedate">@item.ReleaseDate ...</p>
                                    <p class="card-rating"><strong>Rating:</strong> @item.VoteAverage / 10</p>
                            
                            </div>

                    </div>
                    </a>
                </div>
               
            }
        }
    </div>
</div>

<!-- Pagination Controls at the Top -->
@if (Model.TotalPages > 1)
{
    <div class="pagination-controls">
        @if (Model.CurrentPage > 1)
        {
            <a href="@Url.Action("Search", new { query = ViewBag.Query, genre = ViewBag.Genre, actor = ViewBag.Actor, year = ViewBag.Year, page = Model.CurrentPage - 1 })" class="btn btn-primary">Previous</a>
        }

        <span>Page @Model.CurrentPage of @Model.TotalPages</span>

        @if (Model.CurrentPage < Model.TotalPages)
        {
            <a href="@Url.Action("Search", new { query = ViewBag.Query, genre = ViewBag.Genre, actor = ViewBag.Actor, year = ViewBag.Year, page = Model.CurrentPage + 1 })" class="btn btn-primary">Next</a>
        }
    </div>
}